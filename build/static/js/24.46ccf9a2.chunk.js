(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{2208:function(e,t,a){"use strict";a.r(t);var s=a(4),n=a(118),i=a(7),l=a(8),o=a(11),r=a(10),u=a(12),p=a(0),d=a.n(p),c=a(254),m=a(46),y=a(79),g=(a(47),a(229)),h=a.n(g),v=a(303),b=a.n(v),f=a(247),S=a.n(f),C=a(338),_=a.n(C),E=a(645),U=a.n(E),P=a(647),w=a.n(P),x=a(646),D=a.n(x),k=a(62),N=a(526),j=(a(124),a(21)),O=a(43),I=a(14),q=a.n(I),L=a(658),R=j.a.loadUserSettings,F=j.a.saveUserSettings,T=j.a.saveCompanySettings,V={tableName:"settings",displayName:"Settings table",key:"cate_id",display:"cate_name",description:"Settings Table",columns:[{name:"sett_id",display:"Setting ID",type:"number",sequence:"cate_id_seq",mandatory:!0,unique:!0,key:!0},{name:"sett_user_id",display:"User ID",type:"number",mandatory:!0,unique:!0,disabled:!0},{name:"sett_company_name",display:"Company Name",type:"text",mandatory:!0},{name:"sett_company_logo",display:"Logo",type:"picture"},{name:"sett_company_motto",display:"Motto",type:"text"},{name:"sett_company_email",display:"Email",type:"text"},{name:"sett_company_phone",display:"Phone",type:"text"},{name:"sett_indt_id",display:"Industry",type:"text",lov:["Food and Beverage","Clothing","Local Spa","Beauty Products","Retail"]}]},W={tableName:"users",displayName:"Users Records",description:"System User",columns:[{name:"user_id",display:"User Id",type:"number",sequence:"user_id_seq",mandatory:!0,unique:!0,key:!0},{name:"user_fname",display:"First Name",type:"text",mandatory:!0},{name:"user_lname",display:"Surname",type:"text",mandatory:!0},{name:"user_email",display:"Email",type:"text",mandatory:!1},{name:"user_user_pics",display:"User Photo",type:"picture"}]},z=0,M=2,B=3,J=4,Y=function(e){function t(){var e,a;Object(i.a)(this,t);for(var s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return(a=Object(o.a)(this,(e=Object(r.a)(t)).call.apply(e,[this].concat(l)))).state={open:!1,user:{},settings:{},newPass:"",reenterPass:"",statusDetails:z,statusCompany:z,validating:!1,validatingUser:!1},a.validating=function(e,t){a.validate||(a.validate={personal:void 0,company:!1}),a.validate[e]=t},a.componentDidMount=function(){a.props.loadUserSettings()},a.componentWillUnmount=function(){console.log("Unmounted")},a.componentWillReceiveProps=function(e){if(console.log(e),console.log(a.state),e.profile&&(!a.props.profile||!a.state.user.user_id)){a.setState({user:e.profile.user,settings:e.profile.settings});var t=!1;e.profile.settings.sett_company_name&&(t=!0),a.validate={personal:!0,company:t}}!e.success||a.state.statusDetails!==M&&a.state.statusCompany!==M||h()("Saved!","Your Settings have been Saved successfully.","success"),e.success||a.state.statusDetails!==M&&a.state.statusCompany!==M||h()("Failed to Save!","Your Settings have not been saved. Error was "+e.message,"error"),a.state.statusCompany===M&&e.success&&a.setState({statusCompany:J}),a.state.statusDetails===M&&e.success&&a.setState({statusDetails:J}),a.state.statusDetails===M&&!e.success&&e.message&&a.setState({statusDetails:B}),a.state.statusCompany===M&&!e.success&&e.message&&a.setState({statusCompany:B})},a.handleClose=function(){},a.handleUpdate=function(e,t){a.state.user[e]=t},a.handleUpdateCompany=function(e,t){a.state.settings[e]=t},a.handleSave=function(){a.validate&&a.validate.company?(a.setState({statusCompany:M}),a.props.saveCompanySettings(a.state.settings)):a.setState({validating:!0})},a.handleSaveUser=function(){a.validate&&0==a.validate.personal?a.setState(Object(n.a)({validatingUser:!0},"validatingUser",!1)):a.state.newPass===a.state.reenterPass?(a.setState({statusDetails:M,validatingUser:!1}),""!==a.state.newPass&&(a.state.user.user_password=a.state.newPass),a.props.saveUserSettings(a.state.user)):a.setState({validatingUser:!0})},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=1===this.state.statusCompany||1===this.state.statusDetails||this.state.statusCompany===M||this.state.statusDetails===M,a=this.state.statusCompany===J,s=this.state.statusDetails===J,i=this.state.statusCompany===B,l=this.state.statusDetails===B,o=this.props.classes,r=q()(Object(n.a)({},o.buttonSuccess,a));return d.a.createElement(c.a,null,d.a.createElement(m.a,null,d.a.createElement("h3",null,"Personal"),d.a.createElement(N.a,{config:W,open:this.state.open,name:"personal",updateError:this.state.error,updateSuccess:this.state.saved,message:this.state.message,notifyValid:this.validating,validating:this.state.validatingUser,onClose:this.handleClose,onUpdate:this.handleUpdate,updateValue:this.handleUpdate,data:this.state.user,isPanel:!0})),d.a.createElement(m.a,null,d.a.createElement("h4",null,"Password"),d.a.createElement(L.b,{id:"newpass",fullWidth:!0,label:"New Password",type:"password",onChange:function(t){e.setState({newPass:t.target.value})},value:this.state.newPass,InputLabelProps:{shrink:!0}}),d.a.createElement(L.b,{id:"reeneterpass",fullWidth:!0,error:this.state.newPass!==this.state.reenterPass,label:"Re-enter Password",type:"password",onChange:function(t){e.setState({reenterPass:t.target.value})},value:this.state.reenterPass,InputLabelProps:{shrink:!0}})),d.a.createElement(m.a,null,d.a.createElement("div",{style:{position:"relative"}},d.a.createElement(y.a,{style:{marginTop:"6px",marginLeft:"6px"},variant:"fab",color:"primary",className:r,onClick:this.handleSaveUser,disabled:t},s?d.a.createElement(U.a,null):l?d.a.createElement(D.a,null):d.a.createElement(w.a,null)),t&&d.a.createElement(b.a,{size:68,className:o.fabProgress,style:{left:"0px",bottom:"unset"}}))),d.a.createElement(m.a,null,d.a.createElement("h3",null,"Company"),d.a.createElement(N.a,{config:V,open:this.state.open,name:"company",updateError:this.state.error,updateSuccess:this.state.saved,message:this.state.message,notifyValid:this.validating,updateValue:this.handleUpdateCompany,onClose:this.handleClose,onUpdate:this.handleUpdate,data:this.state.settings,validating:this.state.validating,isPanel:!0})),d.a.createElement(m.a,null,d.a.createElement("div",{style:{position:"relative"}},d.a.createElement(y.a,{style:{marginTop:"6px",marginLeft:"6px"},variant:"fab",color:"primary",className:r,onClick:this.handleSave,disabled:t},a?d.a.createElement(U.a,null):i?d.a.createElement(D.a,null):d.a.createElement(w.a,null)),t&&d.a.createElement(b.a,{size:68,className:o.fabProgress,style:{left:"0px",bottom:"unset"}}))))}}]),t}(d.a.Component),A=Object(O.b)(function(e){return Object(s.a)({},e.MasterDetailsReducer)},{loadUserSettings:R,saveUserSettings:F,saveCompanySettings:T})(Y);t.default=Object(k.withStyles)(function(e){return{root:{display:"flex",alignItems:"center"},wrapper:{margin:e.spacing.unit,position:"relative"},buttonSuccess:{backgroundColor:S.a[500],"&:hover":{backgroundColor:S.a[700]}},buttonFailed:{backgroundColor:_.a[500],"&:hover":{backgroundColor:_.a[700]}},fabProgress:{color:S.a[500],position:"absolute",right:20,bottom:20,zIndex:1},buttonProgress:{color:S.a[500],position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}})(A)}}]);
//# sourceMappingURL=24.46ccf9a2.chunk.js.map